<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <h1 id="ha">iframe 2221</h1>
    <script>
        var a = document.getElementById("ha"), popup;
        a.onclick = function () {
            // window.open("https://open.weixin.qq.com/connect/qrconnect?appid=wx268fcfe924dcb171&redirect_uri=https%3A%2F%2Fwww.zhihu.com%2Foauth%2Fcallback%2Fwechat&response_type=code&scope=snsapi_login&state=484f514c4b3270626778595757356f6967646f6e6d4134713750484966524671#wechat", 
            // "_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=no, copyhistory=yes, left:200, top:300, width=400, height=520");
            popup = window.open("http://127.0.0.1:5500/iframe/second.html",
                "_blank", "left=500,top=300,screenX=200,resizable,scrollbars,status,width=400,height=520");
            setTimeout(() => {
                popup.postMessage({ "age": 10 }, 'http://127.0.0.1:5500/iframe/second.html');
            }, 4000)
        }
        window.addEventListener('message', function (event) {
            //接收到新打开的页面传递的值
            console.log('received response:  ', event.data);
            if(event.data){
                popup.close();
            }
        }, false);
        // setTimeout(function () {
        //     // 当前窗口向目标源传数据

        // }, 1000);
    </script>

</body>

</html>